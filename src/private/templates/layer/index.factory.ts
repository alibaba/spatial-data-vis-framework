// $REMOVE_START$
// eslint-disable-next-line @typescript-eslint/ban-ts-comment
// @ts-nocheck

/**
 * @note @warn DO NOT EDIT THIS FILE. IT IS TEMPLATE CODE.
 */
// $REMOVE_END$

/**
 * $LAYER_NAME$
 */
import { StandardLayer, StandardLayerProps } from '@polaris.gl/gsi'

import type { PropDescription } from '../../private/schema/meta'
import {
	DescToParsedType,
	DescToType,
	DescToTypeMutable,
	parseProps,
} from '../../private/utils/props'

/**
 * è¯¦è§ @see {@link [PropDescription](../../private/schema/meta.ts)}
 *
 * Props Description. Used to:
 * - generate default props.
 * - check props type and range.
 * - generate the props editor UI.
 */
export const propsDesc = [
	// example: mutable prop
	{
		name: 'foo',
		key: 'foo',
		type: 'string',
		defaultValue: 'foo-0',
	},
	// example: immutable prop
	{
		name: 'bar',
		key: 'bar',
		type: 'string',
		defaultValue: 'bar-0',
		mutable: true,
	},
	// ğŸ”¨ your stuffs
] as const

// @note type check. will be removed when compile.
propsDesc as readonly PropDescription[]

/**
 * $LAYER_NAME$ Props
 */
type $LAYER_NAME$Props = DescToType<typeof propsDesc>
type $LAYER_NAME$MutableProps = DescToTypeMutable<typeof propsDesc>

/**
 * factory function for $LAYER_NAME$
 *
 * @description å·¥å‚å‡½æ•°æ¨¡å¼è¯´æ˜
 *
 * @note å‡½æ•°å¼ç¼–ç¨‹
 * - propsDesc ä¸­çš„æ‰€æœ‰å±æ€§ï¼Œæ²¡æœ‰æŒ‡æ˜ mutable çš„ï¼Œé»˜è®¤éƒ½ä¸º immutable
 * - immutable å±æ€§å˜åŒ–ï¼Œä¼šé”€æ¯Layerï¼Œç„¶åç”¨å…¨æ–°çš„ props é‡æ–°æ‰§è¡Œå·¥å‚å‡½æ•°
 * - å·¥å‚å‡½æ•°æ— çŠ¶æ€ï¼Œä½†æ˜¯å¯ä»¥é€šè¿‡é—­åŒ…è‡ªè¡Œç¼“å­˜ä¸€äº›è®¡ç®—
 *
 * @legacy å…¼å®¹ç»å…¸çš„ç›‘å¬æ¨¡å¼
 * - å¦‚æœå¸Œæœ›æŸä¸ªå±æ€§å¯ä»¥è¿è¡Œæ—¶é¢‘ç¹å˜åŒ–
 * - - propsDesc ä¸­å°†å…¶æ ‡ä¸º `mutable: true`
 * - - é€šè¿‡ `layer.watchProps()` / `layer.watchProp()` ç›‘å¬å˜åŒ–å¹¶å“åº”
 */
export function create$LAYER_NAME$(props: $LAYER_NAME$Props) {
	console.log('create$LAYER_NAME$')

	// è¡¥å…¨ç¼ºçœå€¼ï¼Œå¹¶æ£€æŸ¥å¿…è¦æ€§ã€ç±»å‹å’Œå€¼èŒƒå›´
	const parsedProps = parseProps(props, propsDesc)

	const layer = new StandardLayer<StandardLayerProps & $LAYER_NAME$MutableProps>({
		name: '$LAYER_NAME$',
		...parsedProps,
	})

	layer.addEventListener('init', async (e) => {
		const { projection, timeline, polaris } = e

		// example: immutable props

		const foo = document.createElement('div')
		layer.element.appendChild(foo)
		foo.innerHTML = `Hello from $LAYER_NAME$. ğŸ‰ foo:${parsedProps.foo}`

		// example: mutable props

		const bar = document.createElement('div')
		layer.element.appendChild(bar)
		// reactions to props change
		layer.watchProps(
			['bar'],
			(event) => {
				bar.innerHTML = `Hello from $LAYER_NAME$. ğŸ‰ bar:${event.props.bar}`
			},
			true // immediate callback with current props
		)

		// ğŸ”¨ your stuffs
	})

	return layer
}
